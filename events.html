<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vista Restaurante | Events</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styling.css">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <h1>VISTA RESTAURANTE</h1>
            </div>
            
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="menu.html">Our Menu</a></li>
                <li><a href="bookings.html">Bookings</a></li>
                <li><a href="events.html">Events</a></li>
                <li><a href="gallery.html">Image Gallery</a></li>
                <li><a href="contact.html">Contact Us</a></li>
            </ul>

            <div class="lang-switch">
    <a href="#" class="lang active">EN</a> 
    <span style="color: #ddd;">|</span> 
    <a href="#" class="lang">ES</a>
</div>

            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
    </header>

    <section class="events-hero">
        <span>Experience Vista</span>
        <h1>Upcoming Events</h1>
    </section>

    <section class="events-list" id="events-container">
        <p style="text-align:center; padding: 50px;">Loading our latest events...</p>
    </section>

    <footer class="main-footer">
        <div class="footer-grid">
            <div class="footer-col">
                <h3>Vista Restaurante</h3>
                <p>Authentic Mediterranean cuisine served with passion and tradition in the heart of the coast.</p>
                <div class="legal-links">
                    <a href="privacy.html">Privacy Policy</a>
                    <a href="terms.html">Terms & Conditions</a>
                </div>
            </div>
            <div class="footer-col">
                <h4>Opening Hours</h4>
                <p>Mon - Thu: 13:00 - 23:00</p>
                <p>Fri - Sun: 13:00 - 00:00</p>
            </div>
            <div class="footer-col">
                <h4>Contact Us</h4>
                <p>Calle Mayor 12, AlmerÃ­a, Spain</p>
                <p>+34 123 456 789</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Vista Restaurante. Built by Vision Web Design Studio.</p>
        </div>
    </footer>

    <div id="cookie-banner" class="cookie-banner">
        <p>We use cookies to ensure you get the best experience on our website. 
           <a href="privacy.html">Learn more</a>
        </p>
        <button id="accept-cookies" class="btn-cookie">Accept</button>
    </div>

    <script>
        // Replace this URL with your "Published as CSV" link
        const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR-HiZVoyJmzm3RER4DunGUXVXF_ITPZz68skz43fxrmaGaO-RaqSedlSVExQsk8uGAoqDaDyy43n_5/pub?output=csv";

        async function fetchEvents() {
            try {
                const response = await fetch(sheetURL);
                const data = await response.text();
                // Split by line, then map each line to an array of columns
                const rows = data.split('\n').slice(1); 
                
                const container = document.getElementById('events-container');
                container.innerHTML = ''; 

                rows.forEach(row => {
                    // This regex helps handle commas inside quotes if a description has a comma
                    const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                    
                    if (cols.length >= 6) {
                        const eventHTML = `
                            <div class="event-card">
                                <div class="event-date">
                                    <span class="day">${cols[0].replace(/"/g, "")}</span>
                                    <span class="month">${cols[1].replace(/"/g, "")}</span>
                                </div>
                                <div class="event-image">
                                    <img src="${cols[6].replace(/"/g, "").trim()}" alt="${cols[3]}">
                                </div>
                                <div class="event-info">
                                    <span class="event-tag">${cols[2].replace(/"/g, "")}</span>
                                    <h2>${cols[3].replace(/"/g, "")}</h2>
                                    <p>${cols[4].replace(/"/g, "")}</p>
                                    <p class="event-time">ðŸ•’ ${cols[5].replace(/"/g, "")}</p>
                                    <a href="bookings.html" class="btn-gold-small">Book a Table</a>
                                </div>
                            </div>
                        `;
                        container.innerHTML += eventHTML;
                    }
                });
            } catch (error) {
                console.error("Error loading events:", error);
                document.getElementById('events-container').innerHTML = "<p style='text-align:center;'>Check back soon for our latest events!</p>";
            }
        }

        fetchEvents();

        // Cookie Banner Script
        const banner = document.getElementById('cookie-banner');
        const btn = document.getElementById('accept-cookies');

        if (localStorage.getItem('cookiesAccepted') === 'true') {
            banner.style.display = 'none';
        }

        btn.addEventListener('click', () => {
            banner.style.display = 'none';
            localStorage.setItem('cookiesAccepted', 'true');
        });
    </script>
</body>
</html>